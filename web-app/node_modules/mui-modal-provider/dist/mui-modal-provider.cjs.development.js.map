{"version":3,"file":"mui-modal-provider.cjs.development.js","sources":["../src/reducer.ts","../src/ModalContext.ts","../src/constants.ts","../src/utils.ts","../src/ModalProvider.tsx","../src/useModal.ts"],"sourcesContent":["import {\r\n  State,\r\n  StateElement,\r\n  ActionMap,\r\n  ModalComponentProps,\r\n  Props,\r\n} from './types';\r\n\r\nexport enum Types {\r\n  SHOW = 'SHOW',\r\n  HIDE = 'HIDE',\r\n  UPDATE = 'UPDATE',\r\n  DESTROY = 'DESTROY',\r\n  DESTROY_BY_ROOT_ID = 'DESTROY_BY_ROOT_ID',\r\n  UNKNOWN = 'UNKNOWN',\r\n}\r\n\r\ntype Payload = {\r\n  [Types.SHOW]: StateElement & {\r\n    id: string;\r\n  };\r\n  [Types.HIDE]: {\r\n    id: string;\r\n  };\r\n  [Types.UPDATE]: {\r\n    id: string;\r\n    props: ModalComponentProps<Props>;\r\n  };\r\n  [Types.DESTROY]: {\r\n    id: string;\r\n  };\r\n  [Types.DESTROY_BY_ROOT_ID]: {\r\n    rootId: string;\r\n  };\r\n  [Types.UNKNOWN]: undefined;\r\n};\r\n\r\ntype Action = ActionMap<Payload>[keyof ActionMap<Payload>];\r\n\r\nexport const initialState: State = {};\r\n\r\nexport default function reducer(state: State, action: Action) {\r\n  switch (action.type) {\r\n    case Types.SHOW: {\r\n      const { id, component, props, options } = action.payload;\r\n\r\n      return {\r\n        ...state,\r\n        [id]: {\r\n          component,\r\n          props: {\r\n            ...props,\r\n            open: true,\r\n          },\r\n          options,\r\n        },\r\n      };\r\n    }\r\n    case Types.HIDE: {\r\n      const { id } = action.payload;\r\n\r\n      if (!state[id]) {\r\n        return state;\r\n      }\r\n\r\n      return {\r\n        ...state,\r\n        [id]: {\r\n          ...state[id],\r\n          props: {\r\n            ...state[id].props,\r\n            open: false,\r\n          },\r\n        },\r\n      };\r\n    }\r\n    case Types.UPDATE: {\r\n      const { id, props } = action.payload;\r\n\r\n      if (!state[id]) {\r\n        return state;\r\n      }\r\n\r\n      return {\r\n        ...state,\r\n        [id]: {\r\n          ...state[id],\r\n          props: {\r\n            ...state[id].props,\r\n            ...props,\r\n          },\r\n        },\r\n      };\r\n    }\r\n    case Types.DESTROY: {\r\n      const { id } = action.payload;\r\n      const newState = { ...state };\r\n      delete newState[id];\r\n      return newState;\r\n    }\r\n    case Types.DESTROY_BY_ROOT_ID: {\r\n      const { rootId } = action.payload;\r\n\r\n      return Object.keys(state)\r\n        .filter(key => key.split('.')[0] !== rootId)\r\n        .reduce<State>(\r\n          (acc, key) => ({\r\n            ...acc,\r\n            [key]: state[key],\r\n          }),\r\n          {}\r\n        );\r\n    }\r\n    default:\r\n      throw new Error('Unexpected action');\r\n  }\r\n}\r\n","import { createContext } from 'react';\r\nimport { initialState } from './reducer';\r\nimport {\r\n  State,\r\n  HideFn,\r\n  ShowFn,\r\n  DestroyFn,\r\n  DestroyByRootIdFn,\r\n  UpdateFn,\r\n} from './types';\r\n\r\nexport type ModalContextState = {\r\n  state: State;\r\n  updateModal: UpdateFn;\r\n  hideModal: HideFn;\r\n  destroyModal: DestroyFn;\r\n  destroyModalsByRootId: DestroyByRootIdFn;\r\n  showModal: ShowFn;\r\n};\r\n\r\nexport const initialContextState = {\r\n  state: initialState,\r\n  hideModal: () => {},\r\n  showModal: () => ({\r\n    id: 'id',\r\n    hide: () => {},\r\n    destroy: () => {},\r\n    update: () => {},\r\n  }),\r\n  destroyModal: () => {},\r\n  updateModal: () => {},\r\n  destroyModalsByRootId: () => {},\r\n};\r\n\r\nconst ModalContext = createContext<ModalContextState>(initialContextState);\r\n\r\nexport default ModalContext;\r\n","export const MISSED_MODAL_ID_ERROR_MESSAGE = '[ERROR]: Modal ID is missing';\r\nexport const MISSED_MODAL_ROOT_ID_ERROR_MESSAGE =\r\n  '[ERROR]: Modal root ID is missing';\r\n","export const uid = (len: number = 8): string => {\r\n  const buf: string[] = [];\r\n  const chars =\r\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n  const charlen = chars.length;\r\n\r\n  for (let i = 0; i < len; i++) {\r\n    buf[i] = chars.charAt(Math.floor(Math.random() * charlen));\r\n  }\r\n\r\n  return buf.join('');\r\n};\r\n","import React from 'react';\r\nimport ModalContext from './ModalContext';\r\nimport reducer, { initialState, Types } from './reducer';\r\nimport {\r\n  DestroyByRootIdFn,\r\n  DestroyFn,\r\n  HideFn,\r\n  ShowFn,\r\n  UpdateFn,\r\n} from './types';\r\nimport {\r\n  MISSED_MODAL_ID_ERROR_MESSAGE,\r\n  MISSED_MODAL_ROOT_ID_ERROR_MESSAGE,\r\n} from './constants';\r\nimport { uid } from './utils';\r\n\r\ntype Props = {\r\n  children: React.ReactNode;\r\n  /**\r\n   * Enable it if you want to use mui < 5 version\r\n   */\r\n  legacy?: boolean;\r\n};\r\n\r\nexport default function ModalProvider({ children, legacy = false }: Props) {\r\n  const [state, dispatch] = React.useReducer(reducer, initialState);\r\n\r\n  const update = React.useCallback<UpdateFn>(\r\n    (id, { open, ...props }) => {\r\n      if (!id) {\r\n        console.error(MISSED_MODAL_ID_ERROR_MESSAGE);\r\n        return;\r\n      }\r\n\r\n      dispatch({\r\n        type: Types.UPDATE,\r\n        payload: {\r\n          id,\r\n          props,\r\n        },\r\n      });\r\n    },\r\n    [dispatch]\r\n  );\r\n\r\n  const hide = React.useCallback<HideFn>(\r\n    id => {\r\n      if (!id) {\r\n        console.error(MISSED_MODAL_ID_ERROR_MESSAGE);\r\n        return;\r\n      }\r\n\r\n      dispatch({\r\n        type: Types.HIDE,\r\n        payload: {\r\n          id,\r\n        },\r\n      });\r\n    },\r\n    [dispatch]\r\n  );\r\n\r\n  const destroy = React.useCallback<DestroyFn>(\r\n    id => {\r\n      if (!id) {\r\n        console.error(MISSED_MODAL_ID_ERROR_MESSAGE);\r\n        return;\r\n      }\r\n\r\n      dispatch({\r\n        type: Types.DESTROY,\r\n        payload: {\r\n          id,\r\n        },\r\n      });\r\n    },\r\n    [dispatch]\r\n  );\r\n\r\n  const destroyByRootId = React.useCallback<DestroyByRootIdFn>(\r\n    rootId => {\r\n      if (!rootId) {\r\n        console.error(MISSED_MODAL_ROOT_ID_ERROR_MESSAGE);\r\n        return;\r\n      }\r\n\r\n      dispatch({\r\n        type: Types.DESTROY_BY_ROOT_ID,\r\n        payload: {\r\n          rootId,\r\n        },\r\n      });\r\n    },\r\n    [dispatch]\r\n  );\r\n\r\n  const show = React.useCallback<ShowFn>(\r\n    (component, props, options) => {\r\n      let id = uid(8);\r\n\r\n      if (options && options.rootId) {\r\n        id = `${options.rootId}.${id}`;\r\n      }\r\n\r\n      dispatch({\r\n        type: Types.SHOW,\r\n        payload: {\r\n          id,\r\n          component,\r\n          props,\r\n          options,\r\n        },\r\n      });\r\n\r\n      return {\r\n        id,\r\n        hide: () => hide(id),\r\n        destroy: () => destroy(id),\r\n        update: newProps => update(id, newProps),\r\n      };\r\n    },\r\n    [dispatch, hide, destroy, update]\r\n  );\r\n\r\n  const renderState = () =>\r\n    Object.keys(state).map(id => {\r\n      const { component: Component, props, options } = state[id];\r\n\r\n      const handleClose = (...args: any[]) => {\r\n        if (options && options.destroyOnClose) {\r\n          destroy(id);\r\n        } else {\r\n          hide(id);\r\n        }\r\n\r\n        if (props && props.onClose) {\r\n          props.onClose(...args);\r\n        }\r\n      };\r\n\r\n      const handleExited = (...args: any[]) => {\r\n        if (props?.onExited) {\r\n          props.onExited(...args);\r\n        }\r\n\r\n        if (props?.TransitionProps?.onExited) {\r\n          props.TransitionProps.onExited(...args);\r\n        }\r\n\r\n        destroy(id);\r\n      };\r\n\r\n      let extraProps = {};\r\n\r\n      if (!legacy) {\r\n        extraProps = {\r\n          TransitionProps: {\r\n            ...props?.TransitionProps,\r\n            onExited: handleExited,\r\n          },\r\n        };\r\n      } else {\r\n        extraProps = {\r\n          onExited: handleExited,\r\n        };\r\n      }\r\n\r\n      return (\r\n        <Component\r\n          {...props}\r\n          key={id}\r\n          onClose={handleClose}\r\n          {...(options && !options.destroyOnClose && extraProps)}\r\n        />\r\n      );\r\n    });\r\n\r\n  return (\r\n    <ModalContext.Provider\r\n      value={{\r\n        state,\r\n        updateModal: update,\r\n        hideModal: hide,\r\n        destroyModal: destroy,\r\n        showModal: show,\r\n        destroyModalsByRootId: destroyByRootId,\r\n      }}\r\n    >\r\n      {children}\r\n      {renderState()}\r\n    </ModalContext.Provider>\r\n  );\r\n}\r\n","import { useContext, useCallback, useEffect, useRef } from 'react';\r\nimport { ShowFn } from './types';\r\n\r\nimport ModalContext from './ModalContext';\r\nimport { uid } from './utils';\r\n\r\ntype Options = {\r\n  disableAutoDestroy?: boolean;\r\n};\r\n\r\nconst defaultOptions: Options = {\r\n  disableAutoDestroy: false,\r\n};\r\n\r\nexport default function useModal(options: Options = defaultOptions) {\r\n  const { disableAutoDestroy } = { ...defaultOptions, ...options };\r\n  const {\r\n    showModal,\r\n    destroyModalsByRootId: destroy,\r\n    ...otherContextProps\r\n  } = useContext(ModalContext);\r\n  const id = useRef<string>(uid(6));\r\n\r\n  useEffect(\r\n    () => () => {\r\n      if (!disableAutoDestroy) {\r\n        destroy(id.current);\r\n      }\r\n    },\r\n    [disableAutoDestroy, destroy]\r\n  );\r\n\r\n  return {\r\n    showModal: useCallback<ShowFn>(\r\n      (component, props, options) =>\r\n        showModal(component, props, { rootId: id.current, ...options }),\r\n      [showModal]\r\n    ),\r\n    ...otherContextProps,\r\n  };\r\n}\r\n"],"names":["Types","initialState","reducer","state","action","type","SHOW","payload","id","component","props","options","open","HIDE","UPDATE","DESTROY","newState","DESTROY_BY_ROOT_ID","rootId","Object","keys","filter","key","split","reduce","acc","Error","initialContextState","hideModal","showModal","hide","destroy","update","destroyModal","updateModal","destroyModalsByRootId","ModalContext","createContext","MISSED_MODAL_ID_ERROR_MESSAGE","MISSED_MODAL_ROOT_ID_ERROR_MESSAGE","uid","len","buf","chars","charlen","length","i","charAt","Math","floor","random","join","ModalProvider","children","legacy","React","useReducer","dispatch","useCallback","console","error","destroyByRootId","show","newProps","renderState","map","Component","handleClose","destroyOnClose","onClose","handleExited","onExited","TransitionProps","extraProps","Provider","value","defaultOptions","disableAutoDestroy","useModal","useContext","otherContextProps","useRef","useEffect","current"],"mappings":"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"}